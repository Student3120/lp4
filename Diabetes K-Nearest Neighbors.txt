# Assignment - K-Nearest Neighbors on Diabetes Dataset

# Step 1: Import Libraries
import pandas as pd
import numpy as np
import seaborn as sns
import matplotlib.pyplot as plt
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler
from sklearn.neighbors import KNeighborsClassifier
from sklearn import metrics
import warnings
warnings.filterwarnings('ignore')

# Step 2: Load Dataset
df = pd.read_csv("D:/diabetes.csv")   # change path if needed
print("Dataset Shape:", df.shape)
print(df.head())

# Step 3: Check for Missing Values
print("\nMissing Values:\n", df.isnull().sum())

# Step 4: Split Features and Target
X = df.drop('Outcome', axis=1)
y = df['Outcome']

# Step 5: Feature Scaling
scaler = StandardScaler()
X_scaled = scaler.fit_transform(X)

# Step 6: Train-Test Split
X_train, X_test, y_train, y_test = train_test_split(X_scaled, y, test_size=0.3, random_state=42)

# Step 7: Apply K-Nearest Neighbors
knn = KNeighborsClassifier(n_neighbors=5)
knn.fit(X_train, y_train)
y_pred = knn.predict(X_test)

# Step 8: Compute Confusion Matrix and Metrics
cm = metrics.confusion_matrix(y_test, y_pred)
accuracy = metrics.accuracy_score(y_test, y_pred)
precision = metrics.precision_score(y_test, y_pred)
recall = metrics.recall_score(y_test, y_pred)
error_rate = 1 - accuracy

print("\nConfusion Matrix:\n", cm)
print(f"\nAccuracy: {accuracy:.4f}")
print(f"Error Rate: {error_rate:.4f}")
print(f"Precision: {precision:.4f}")
print(f"Recall: {recall:.4f}")

# Step 9: Classification Report
print("\nClassification Report:\n", metrics.classification_report(y_test, y_pred))

# Step 10: Visualization - Confusion Matrix
plt.figure(figsize=(6,4))
sns.heatmap(cm, annot=True, fmt='d', cmap='Blues')
plt.title("Confusion Matrix - KNN on Diabetes Dataset")
plt.xlabel("Predicted")
plt.ylabel("Actual")
plt.show()
